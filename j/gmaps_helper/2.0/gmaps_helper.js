function bindClick(o,e,t,n){google.maps.event.addListener(o,"click",function(){t.open()})}function bindRollover(o,e,t,n){google.maps.event.addListener(o,"mouseover",function(){t.open(e,o)})}function bindRollout(o,e,t,n){google.maps.event.addListener(o,"mouseout",function(){t.close()})}function trace(o){console.log(o)}var debug=!1,map,infoWindow,locationList=[],markerList=[],markerID=0,proxy={map:{center:null,zoom:15,id:"map"},infowindow:{autopan:!0,object:null},init:function(){function o(o){trace("location accuracy: "+o.coords.accuracy),proxy.map.center=new google.maps.LatLng(o.coords.latitude,o.coords.longitude),proxy.setMap()}function e(o){proxy.fuzzyLocator("http://www.google.com/jsapi",function(){google.loader.ClientLocation&&(proxy.map.center=new google.maps.LatLng(google.loader.ClientLocation.latitude,google.loader.ClientLocation.longitude),proxy.setMap())})}proxy.map.center?proxy.setMap():navigator.geolocation.getCurrentPosition(o,e)},setMap:function(){map=new google.maps.Map(document.getElementById(proxy.map.id),proxy.map),infoWindow=new google.maps.InfoWindow({disableAutoPan:proxy.infowindow.autopan})},center:function(o,e){map.setCenter(o?o:proxy.map.center),o&&e&&(proxy.map.center=o)},geoCode:function(o,e,t){var n=new google.maps.Geocoder;n.geocode({address:o},function(o,n){n==google.maps.GeocoderStatus.OK?(console.log(o),e&&map.setCenter(o[0].geometry.location),t&&marker(t)):console.log("Geocode was not successful for the following reason: "+n)})},addMarker:function(o){var e;e="string"==String(typeof o.loc)?new google.maps.LatLng(o.loc.split(",")[0],o.loc.split(",")[1]):o.loc;var t=new google.maps.Marker({id:markerID,map:map,position:e});o.icon&&t.setIcon(o.icon),o.info&&(t.info=o.info),o.event&&(t.event=o.event),locationList.push(t.position),markerList.push(t),markerID++,t.setMap(map),google.maps.event.addListener(t,"click",function(){this.event&&this.event.click?this.event.click(this):trace(this.id)}),google.maps.event.addListener(t,"mouseover",function(){this.event&&this.event.over&&this.event.over(this)}),google.maps.event.addListener(t,"mouseout",function(){this.event&&this.event.out&&this.event.out(this)})},clearMarkers:function(){proxy.setAllMap(null),markerList=[],markerID=0,locationList=[]},hideMarkers:function(){proxy.setAllMap(null)},showMakers:function(){proxy.setAllMap(map)},setAllMap:function(o){markerList.length&&markerList.forEach(function(e){e.setMap(o)})},locateUser:function(o,e){function t(t){trace("location accuracy: "+t.coords.accuracy),a=new google.maps.LatLng(t.coords.latitude,t.coords.longitude),o&&map.setCenter(a),e(a)}function n(t){proxy.fuzzyLocator("http://www.google.com/jsapi",function(){google.loader.ClientLocation&&(a=new google.maps.LatLng(google.loader.ClientLocation.latitude,google.loader.ClientLocation.longitude),o&&map.setCenter(a),e(a))})}if(!e)var e=function(){};trace("locating user..."),navigator.geolocation.getCurrentPosition(t,n);var a},fuzzyLocator:function(o,e){function t(o,e){trace("fallback to: "+o);var t=document.createElement("script");t.src=o,t.async=!0,t.onreadystatechange=t.onload=function(){var o=t.readyState;e.done||o&&!/loaded|complete/.test(o)||(e.done=!0,e())},document.getElementsByTagName("head")[0].appendChild(t)}t(o,e)},find:function(o,e){trace("finding: "+o);var t=new google.maps.Geocoder;t.geocode({address:o},function(t,n){n==google.maps.GeocoderStatus.OK?(trace("coordinates for "+o+" is: "+t[0].geometry.location),e(t[0].geometry.location)):(trace("Geocode was not successful for the following reason: "+n),e(null))})},resolve:function(o,e){trace("resolve: "+o);var t=new google.maps.Geocoder;t.geocode({latLng:o},function(o,t){t==google.maps.GeocoderStatus.OK?o?(trace("success"),e(o)):(trace("no results"),e(null)):(trace("reverse geocoding failed due to: "+t),e(null))})},fit:function(){var o=new google.maps.LatLngBounds;0==locationList.length&&locationList.push(proxy.map.center),locationList.forEach(function(e){o.extend(e)}),map.setCenter(o.getCenter()),map.fitBounds(o)}};