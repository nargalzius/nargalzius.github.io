var video={mTypes:{mp4:"video/mp4",ogv:"video/ogg",webm:"video/webm"},isMobile:!1,isFS:!1,zindex:null,poster:null,proxy:null,container:null,controller:null,bigplay:null,bigsound:null,replay:null,spinner:null,autoplay:!1,clickforsound:!1,replaywithsound:!1,firstTime:!0,playhead:0,duration:0,buffered:0,pbar:null,phead:null,init:function(e){video.container=e,video.zindex=parseInt(video.container.css("zIndex"),10),video.zindex||(video.zindex=0,trace("z-index for video container element not detected, make sure position property is set")),document.addEventListener("fullscreenchange",function(){console.log(document.fullscreen),video.isFS=!1},!1),document.addEventListener("mozfullscreenchange",function(){console.log(document.mozFullScreen),video.isFS=!1},!1),document.addEventListener("webkitfullscreenchange",function(){console.log(document.webkitIsFullScreen),video.isFS=!1},!1),$("<div>").attr({id:"v_player"}).css({zIndex:video.zindex,position:"absolute"}).appendTo(video.container),video.poster=$("<img>").attr({id:"v_poster"}).css({zIndex:video.zindex+2,position:"absolute","background-color":"#000",display:"block",width:"100%",height:"100%"}).appendTo(video.container),video.controller=$("<div>").attr({id:"v_controls"}).css({display:"block",zIndex:video.zindex+1,position:"relative",height:"25px",top:video.container.height()-25,left:0}).appendTo(video.container),$("<div>").attr("id","v_controls_cbg").css({display:"block",position:"absolute","background-color":"#000",opacity:.6,width:"100%"}).appendTo(video.controller),$("<span>").attr("id","v_controls_btn_play").addClass("cbtn fa fa-play").css({display:"block",position:"absolute",cursor:"pointer",color:"#FFF",top:5,left:5,"font-size":15}).appendTo(video.controller),$("<span>").attr("id","v_controls_btn_pause").addClass("cbtn fa fa-pause").css({display:"block",position:"absolute",cursor:"pointer",color:"#FFF",top:5,left:5,"font-size":15}).hide().appendTo(video.controller),$("<span>").attr("id","v_controls_btn_mute").addClass("cbtn fa fa-volume-up").css({display:"block",position:"absolute",cursor:"pointer",color:"#FFF",top:4,right:30,width:12,"font-size":18}).appendTo(video.controller),$("<span>").attr("id","v_controls_btn_unmute").addClass("cbtn fa fa-volume-off").css({display:"block",position:"absolute",cursor:"pointer",color:"#FFF",top:4,right:30,width:12,"font-size":18}).hide().appendTo(video.controller),$("<span>").attr("id","v_controls_btn_fs").addClass("cbtn fa fa-expand").css({display:"block",position:"absolute",cursor:"pointer",color:"#FFF",top:5,right:5}).appendTo(video.controller);var o=$("<div>").attr("id","v_controls_scrubber").css({position:"absolute",display:"block",height:4,width:"100%",top:-4,cursor:"pointer"}).appendTo(video.controller);video.pbar=$("<div>").attr("id","v_controls_scrubber_progress").css({position:"absolute",display:"block",height:"100%",width:0,top:0}).appendTo(o).click(function(e){0!=$("#v_controls_scrubber_progress:hover").length&&video.barSeek(e)}),video.phead=$("<div>").attr("id","v_controls_scrubber_playback").css({position:"absolute",display:"block",height:"100%",width:0,top:0}).appendTo(o).click(function(e){0!=$("#v_controls_scrubber_playback:hover").length&&video.barSeek(e)}),video.bigplay=$("<span>"),video.bigplay.attr("id","v_controls_btn_bigplay").addClass("cbtn v_controls_bb fa fa-play-circle-o fa-4x").css({zIndex:video.zindex+3,display:"block",position:"absolute",cursor:"pointer",color:"#FFF"}).appendTo(video.container),video.bigplay.css({top:(video.container.height()-video.bigplay.height())/2,left:(video.container.width()-video.bigplay.width())/2}).hide(),video.replay=$("<span>"),video.replay.attr("id","v_controls_btn_bigreplay").addClass("cbtn v_controls_bb fa fa-repeat fa-3x").css({zIndex:video.zindex+3,display:"block",position:"absolute",cursor:"pointer",color:"#FFF"}).appendTo(video.container),video.replay.css({top:(video.container.height()-video.replay.height())/2,left:(video.container.width()-video.replay.width())/2}).hide(),video.bigsound=$("<span>"),video.bigsound.attr("id","v_controls_clickforsound").addClass("cbtn v_controls_bb fa fa-volume-up fa-3x").css({zIndex:video.zindex+3,display:"block",position:"absolute",cursor:"pointer",color:"#FFF"}).appendTo(video.container),video.bigsound.css({top:(video.container.height()-video.bigsound.height())/2,left:(video.container.width()-video.bigsound.width())/2}).hide(),video.spinner=$("<span>"),video.spinner.attr("id","v_controls_spinner").addClass("v_controls_bb fa fa-circle-o-notch fa-spin fa-3x").css({zIndex:video.zindex+3,display:"block",position:"absolute",color:"#FFF"}).appendTo(video.container),video.spinner.css({top:(video.container.height()-video.spinner.height())/2,left:(video.container.width()-video.spinner.width())/2}).hide()},barSeek:function(e){var o=e.pageX-video.pbar.offset().left,i=o/video.container.width();video.seek(video.duration*i)},seek:function(e){video.proxy.currentTime=e},load:function(e,o){video.firstTime=!0,video.spinner.show(),o&&video.setPoster(o),setTimeout(function(){var o=$("<video>").attr({id:"v_element",width:video.container.width(),height:video.container.height()}).appendTo("#v_player");video.autoplay&&!video.isMobile&&o.prop("autoplay",!0),video.isMobile&&(o.prop("controls",!0),video.controller.hide()),$.isArray(e)?e.forEach(function(e){$("<source>").attr({src:e,type:video.getMediaType(e)}).appendTo(o)}):$("<source>").attr({src:e,type:video.getMediaType(e)}).appendTo(o),video.proxy=document.getElementById("v_element"),video.setListeners()},500)},setPoster:function(e){var o=new Image;o.onload=function(){trace("loaded: "+e),video.poster.attr("src",e).show(),video.isMobile&&(video.spinner.hide(),video.bigplay.show())},o.src=e},destroy:function(){$("#vplayer").children().filter("video").each(function(){trace(this),this.pause(),$(this).children("source").prop("src",""),delete this,$(this).remove()})},setListeners:function(){video.proxy.addEventListener("ended",video.dlEnded),video.proxy.addEventListener("play",video.dlPlay),video.proxy.addEventListener("pause",video.dlPause),video.proxy.addEventListener("volumechange",video.dlVolumeChange),video.proxy.addEventListener("timeupdate",video.dlTimeUpdate),video.proxy.addEventListener("canplay",video.dlCanPlay),video.proxy.addEventListener("progress",video.dlProgress),$(".cbtn").click(video.controlHandler),video.container.mouseenter(function(e){video.isFS||video.bigsound.is(":visible")||video.isMobile||video.controller.show()}).mouseleave(function(e){video.controller.hide()})},removeListeners:function(){video.proxy.removeEventListener("ended",video.dlEnded),video.proxy.removeEventListener("play",video.dlPlay),video.proxy.removeEventListener("pause",video.dlPause),video.proxy.removeEventListener("volumechange",video.dlVolumeChange),video.proxy.removeEventListener("timeupdate",video.dlTimeUpdate),video.proxy.removeEventListener("canplay",video.dlCanPlay)},dlEnded:function(){video.replay.show(),video.poster.show(),video.bigsound.hide(),video.ulEnded()},dlPlay:function(){$("#v_controls_btn_pause").show(),$("#v_controls_btn_play").hide(),video.ulPlay()},dlPause:function(){$("#v_controls_btn_pause").hide(),$("#v_controls_btn_play").show(),video.ulPause()},dlVolumeChange:function(){video.proxy.muted?($("#v_controls_btn_mute").hide(),$("#v_controls_btn_unmute").show()):($("#v_controls_btn_mute").show(),$("#v_controls_btn_unmute").hide(),video.bigsound.hide()),video.ulVolumeChange()},dlProgress:function(){for(var e=0;e<video.proxy.buffered.length;e++)video.buffered=video.proxy.buffered.end(e)/video.duration*100;video.pbar.css("width",video.buffered+"%"),video.ulProgress()},dlTimeUpdate:function(){video.firstTime&&(video.firstTime=!1,video.clickforsound&&video.autoplay&&!video.isMobile&&(video.proxy.muted=!0,video.bigsound.show(),video.controller.hide())),video.bigplay.is(":visible")&&video.bigplay.hide(),video.replay.is(":visible")&&video.replay.hide(),video.spinner.is(":visible")&&video.spinner.hide(),video.poster.is(":visible")&&video.poster.hide(),video.playhead=video.proxy.currentTime,video.duration=video.proxy.duration;var e=video.playhead/video.duration*100;video.phead.css("width",e+"%"),video.ulTimeUpdate()},dlCanPlay:function(){video.firstTime&&(video.spinner.hide(),video.isMobile||video.bigplay.show(),video.ulCanPlay())},ulEnded:function(){trace("Video Ended")},ulPlay:function(){trace("Video Play")},ulPause:function(){trace("Video Paused")},ulVolumeChange:function(){trace("Video Volume Change")},ulProgress:function(){},ulTimeUpdate:function(){},ulCanPlay:function(){trace("Video Ready")},controlHandler:function(e){switch(e.currentTarget.id){case"v_controls_btn_play":video.proxy.play();break;case"v_controls_btn_pause":video.proxy.pause();break;case"v_controls_btn_mute":video.proxy.muted=!0;break;case"v_controls_btn_unmute":video.proxy.muted=!1;break;case"v_controls_btn_fs":video.goFS();break;case"v_controls_btn_bigplay":video.proxy.play(),video.spinner.show(),video.bigplay.hide();break;case"v_controls_btn_bigreplay":video.proxy.play(),video.spinner.show(),(video.replaywithsound||video.isMobile)&&(video.proxy.muted=!1),video.isMobile?video.controller.hide():video.controller.show();break;case"v_controls_clickforsound":video.proxy.muted=!1,video.proxy.currentTime=0,video.controller.show()}},goFS:function(){trace("request fullscreen"),video.proxy.requestFullscreen?(video.proxy.requestFullscreen(),video.isFS=!0):video.proxy.mozRequestFullScreen?(video.proxy.mozRequestFullScreen(),video.isFS=!0):video.proxy.webkitRequestFullscreen&&(video.proxy.webkitRequestFullscreen(),video.isFS=!0)},getMediaType:function(e){return video.mTypes[e.split(".")[e.split(".").length-1]]}};